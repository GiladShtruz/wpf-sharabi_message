<Window x:Class="SharabiProject.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SharabiProject"
        mc:Ignorable="d"
        FlowDirection="RightToLeft"
        Title="שרעבי הזמנות" Height="550" Width="950">
    <Window.Resources>
        <DataTemplate
            x:Key="CustomerListTemplate"
            DataType="local:Customer">
            <Grid Margin="0,2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Text="{Binding FirstName}" Grid.Column="0"/>
                <TextBlock Text="{Binding PhoneNumber}" Grid.Column="1"/>
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="MyCsvTemplate"
                      DataType="local:CropItem"
                      >

            <StackPanel Orientation="Horizontal" >
                <!--ToggleButton.-->
                <CheckBox 
                          Content=" "
                          x:Name="checkbox"
                          Width="Auto"                   
                          IsChecked="{Binding Path=IsIncludeInMessage}" ></CheckBox>
                <TextBox     
                    IsReadOnly="True"  
                   BorderBrush="#00000000"
                   TextWrapping="Wrap"                                                                
                           Text="{Binding Path=CropName}"
                           IsEnabled="{Binding ElementName=checkbox, Path=IsChecked}"/>

                <TextBox          
                    
                     Margin="5,0,0,0"
                     MinWidth="15"
                    TextAlignment="Center"
                     Text="{Binding Path=CropPrice}" 
                     IsEnabled="{Binding ElementName=checkbox, Path=IsChecked}"/>
                <TextBox 
                         IsReadOnly="True"  
                   BorderBrush="#00000000"                    
                    TextWrapping="Wrap"
                   
                           Text="₪" 
                           Width="Auto"                           
                           IsEnabled="{Binding ElementName=checkbox, Path=IsChecked}"/>
                <!--IsEnabled="{Binding ElementName=checkbox,
                                             Path=IsChecked,
                                             Converter={StaticResource notBooleanToVisibilityConverter}}"-->



            </StackPanel>
        </DataTemplate>
    </Window.Resources>


    <Grid
        Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
            <RowDefinition />
            <RowDefinition Height="40"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition  />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <ScrollViewer 
            Grid.Row="1" 
            Grid.RowSpan="2"
            Grid.Column="1" 
            VerticalScrollBarVisibility="Auto">
            <TextBlock x:Name="updateMessageToStav" Text="" />
        </ScrollViewer>
        <StackPanel
            Grid.Row="0"
            HorizontalAlignment="Left">
            <Button Content="הגדרות" Click="ClickSettingButton" x:Name="settingButton" />

        </StackPanel>

        <StackPanel 
            Orientation="Horizontal"
            Grid.Row="0"  
            HorizontalAlignment="Center"
            >
            <TextBlock 
               Text="קישור לטופס: "
               FontWeight="Bold" />
            <TextBox         
                Margin="10,0"
                x:Name="urlTextBox"
                MaxLines="1"
                Width="300"
                Height="30"
               Text=""
               FontWeight="Bold" />
            <Button 
                Content="עדכן טופס" 
                x:Name="updateCsvFile"
                    Click="Btn_Update_Url"/>


        </StackPanel>
        <Grid x:Name="grid1Property"            
            Grid.Row="1">
            <!--<Grid.Resources>
                <Style TargetType="TextBlock">
                    <Setter Property="Padding" Value="5,5,5,5" />
                </Style>
            </Grid.Resources>-->
            <!--רשת לעמודה השנייה-->
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions >
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />

            </Grid.ColumnDefinitions>
            <TextBlock Grid.Row="0" Grid.Column="0" Text="פירוט מוצרים:" FontWeight="Bold" />
            <ListBox 
                Grid.Row="1"
                Grid.Column="0"
                x:Name="cropListBox"
                FlowDirection="RightToLeft"
            ItemsSource="{Binding}"
             ItemTemplate="{StaticResource MyCsvTemplate}"
                 HorizontalContentAlignment="Stretch">
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                        <Setter Property="Focusable" Value="False"/>
                    </Style>
                </ListBox.ItemContainerStyle>
            </ListBox>
            <Button Grid.Row="2" Grid.Column="0" x:Name="btnUpdateCropList" Content="עדכן" Click="BtnUpdateCropList_Click" />


            <TextBlock Grid.Row="0" Grid.Column="1" Text="ההודעה ללקוחות:"  FontWeight="Bold" />
            <RichTextBox
                Grid.Row="1"
                Grid.RowSpan="2"
                Grid.Column="1"
                x:Name="msgToCustomers"
                FlowDirection="RightToLeft"
                AcceptsReturn="True"
                AcceptsTab="True"          
                Width="Auto"                                    
                SpellCheck.IsEnabled="True" Language="he-IL"  
                TextChanged="MsgToCustomers_TextBoxChanged">
                <RichTextBox.Resources>
                    <Style TargetType="{x:Type Paragraph}">
                        <Setter Property="Margin" Value="0" />
                    </Style>
                </RichTextBox.Resources>
                <FlowDocument>
                    <Paragraph>שלום נמען!
                        <LineBreak />
                        ביצעת הזמנה של מוצרים ממשק שרעבי.
                        <LineBreak />
                        להלן פירוט ההזמנה:
                        <LineBreak />
                        #
                        <LineBreak />
                        זה יוצא $
                        <LineBreak />
                        תישלח הודעה כשההזמנה תהיה מוכנה (:
                    </Paragraph>
                </FlowDocument>
            </RichTextBox>
            <ScrollViewer Grid.Row="1" Grid.Column="2" VerticalScrollBarVisibility="Auto">
                <TextBox     
                    IsReadOnly="True"  
                   BorderBrush="#00000000"
                   TextWrapping="Wrap"         
                    x:Name="exampleMsgToCustomer"
                    Margin="10,0,0,0"
                           
                           IsEnabled="{Binding ElementName=checkbox, Path=IsChecked}"/>
                <!--<TextBlock  Margin="10,0,0,0"  x:Name="exampleMsgToCustomer" Text=""  />-->
            </ScrollViewer>
            <Button Margin="10,0,0,0" x:Name="btnCopyMsg" Grid.Row="2" Grid.Column="2" Content="העתק" Click="btnCopyMsg_Click"/>
        </Grid>
        <Grid     x:Name="grid2Property"        
            Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"   />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*"  />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>


            <!--כפתור שליחה אוטומטית:-->
            <TextBlock Grid.Row="0" Grid.Column="0" Text="שליחה אוטומטית:" FontWeight="Bold"   />
            <Button x:Name="autoMsgBtn" Content="כבוי" Grid.Row="1"  Grid.Column="0" Height="30" Margin="0,0,5,0" FontSize="18" FontWeight="Medium"   Click="btnAutoMsg_Click"/>
            <TextBlock Grid.Row="2" Grid.Column="0" Text="מחק מהזמנות חדשות:" FontWeight="Bold" Margin="0"  />
            <Button x:Name="btnRemoveFromNewOrders" Content="מחק לקוח" Grid.Row="3"  Grid.Column="0" Margin="0,0,5,0" Height="30" FontSize="18" FontWeight="Medium"  Click="btnRemoveFromNewOrders_Click" />
            <TextBlock Grid.Row="4" Grid.Column="0" Text="איפוס הזמנות:" FontWeight="Bold"  />
            <Button x:Name="btnRemoveAllNewOrders" Content="אפס הכל" Grid.Row="5" Grid.Column="0" Margin="0,0,5,0" Height="30" FontSize="18" FontWeight="Medium" Click="btnRemoveAllNewOrders_Click" />

            <TextBlock Grid.Row="0" Grid.Column="0" Text="השליחה האוטומטית תפעל בימים:" FontWeight="Bold"  Visibility="Collapsed"/>
            <WrapPanel Grid.Row="1" Grid.Column="0" Visibility="Collapsed">
                <ListBox
                    x:Name="daysListBox"
                    Width="220"
                    Margin="0,0,5,0"
                ScrollViewer.HorizontalScrollBarVisibility="Disabled"                
            SelectionMode="Multiple"
            >
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel IsItemsHost="True" />
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                    <TextBlock Text="יום ראשון" />
                    <TextBlock Text="יום שני" />
                    <TextBlock Text="יום שלישי" />
                    <TextBlock Text="יום רביעי" />
                    <TextBlock Text="יום חמישי" />
                    <TextBlock Text="יום שישי" />
                    <TextBlock Text="יום שבת" />
                </ListBox>
            </WrapPanel >
            <WrapPanel  Grid.Row="2" Grid.Column="0" Visibility="Collapsed">
                <ListBox  Height="80" SelectionChanged="ListBox_SelectionChanged" x:Name="listChooseHour" >
                    <TextBlock Text="בין השעות" Selector.IsSelected="True"/>
                    <TextBlock Text="כל הזמן" />
                </ListBox>
                <StackPanel x:Name="betweenHours" Orientation="Horizontal">
                    <StackPanel Margin="5,0">
                        <TextBlock Text="שעת התחלה:" />
                        <ComboBox x:Name="startTimeCB"/>
                    </StackPanel>

                    <StackPanel>
                        <TextBlock Text="שעת סיום:" />
                        <ComboBox x:Name="finishTimeCB" />
                    </StackPanel>
                </StackPanel>
            </WrapPanel>
            <WrapPanel Grid.Row="3" Grid.Column="0" Orientation="Vertical" Visibility="Collapsed">
                <TextBlock Text="השליחה תתבצע כל 30 דקות" x:Name="timeToWaitTextBlock"/>
                <Slider x:Name="sliderTime" Maximum="60" Minimum="10" TickFrequency="5" TickPlacement="BottomRight" Value="30" IsSnapToTickEnabled="True" ValueChanged="sliderTimeValueCahange" />
                <!--<Button Content="החל" Click="btnUpdateTime" />-->
            </WrapPanel>

            <TextBlock Grid.Row="0" Grid.Column="1" Text="כל הלקוחות:"  FontWeight="Bold"/>
            <ListBox Grid.Row="1" Grid.Column="1" Margin="0,0,5,0" Grid.RowSpan="5" Name="allCustomersListBox" HorizontalContentAlignment="Stretch" SelectionChanged="AllCustomerList_SelectionChanged" ItemTemplate="{StaticResource CustomerListTemplate}" />


            <TextBlock Grid.Row="0" Grid.Column="2" Text="הזמנות חדשות:"  FontWeight="Bold" />
            <WrapPanel 
                AllowDrop="True"
                
                Orientation="Vertical"
                HorizontalAlignment="Center"       
                Grid.Row="5" Grid.Column="2">
                <TextBlock x:Name="timeToSendTextBlock"  Text=" שליחה אוטומטית לא פעילה"  FontWeight="Bold"> </TextBlock>
                <Button x:Name="sendNewOrdersNow" Content="שלח עכשיו" HorizontalAlignment="Center" Margin="0,3" Click="Btn_Send_Oreders_Now" Visibility="Collapsed"/>

            </WrapPanel>
            <ListView Grid.Row="1" Grid.Column="2" Margin="0,0,5,0" Grid.RowSpan="4" x:Name="newOrdersListBox" HorizontalContentAlignment="Stretch" SelectionChanged="NewOrdersListBox_SelectionChanged" ItemTemplate="{StaticResource CustomerListTemplate}"  />
            <TextBlock Grid.Row="0" Grid.Column="3" Text="לא באנשי קשר:" FontWeight="Bold" />
            <ListBox Grid.Row="1" Grid.Column="3" Margin="0,0,5,0" Grid.RowSpan="5" x:Name="notInContactListBox" HorizontalContentAlignment="Stretch" SelectionChanged="NotInContactListBox_SelectionChanged" ItemTemplate="{StaticResource CustomerListTemplate}" />
            <TextBlock Grid.Row="0" Grid.Column="4" Text="מספרי טלפון שגויים:" FontWeight="Bold" />
            <ListBox Grid.Row="1" Grid.Column="4" Margin="0,0,5,0" Grid.RowSpan="5" x:Name="problemPhoneNumberListBox" HorizontalContentAlignment="Stretch" SelectionChanged="problemPhoneNumberListBox_SelectionChanged" ItemTemplate="{StaticResource CustomerListTemplate}" />
        </Grid>
        <!--stop here-->

        <Grid Grid.Row="3" >
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Button 
                x:Name="btnSendOrdersNow"            
                Height="30"
                Margin="5"
                Grid.Column="0"
                Content="שלח הודעת ניסיון"
                Click="btnSendTestMessage" 
            />
            <Button 
                x:Name="btnSendMessageToAll"                            
                Grid.Column="1"
                Height="30"
                Margin="5"
                Content="שלח לכל ההזמנות החדשות"                
                Click="Btn_Send_Oreders_Now" 
            />
        </Grid>

        <WrapPanel Grid.Row="4" Orientation="Vertical" Visibility="Collapsed" x:Name="seleniumProgresBar">
            <TextBlock Text="מבצע שליחת הודעות. על מנת לעצור יש לסגור את הגוגל כרום" />
            <ProgressBar 
                IsIndeterminate="True"
                Height="15"
                         Width="60"/>

        </WrapPanel>


    </Grid>
</Window>

